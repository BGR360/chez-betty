{% extends "base.jinja2" %}
{% block title %}Home{% endblock %}

{% block top %}

<h1 class="page-header">Chez Betty Admin Panel</h1>

{% endblock %}


{% block content %}
<div class="row">
  <div class="col-md-5">

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Account Information</h3>
      </div>
      <div class="panel-body">

        <div class="row">
          <div class="col-md-6">
            <table class="table">
              <thead>
                <tr>
                  <th colspan="2">Virtual Accounts</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Chez Betty</td>
                  <td class="right">{{ chezbetty.balance|format_currency|safe }}</td>
                </tr>
                <tr>
                  <td>Users</td>
                  <td class="right">{{ users_total_balance|format_currency|safe }}</td>
                </tr>
                <tr>
                  <td>Lost/Stolen</td>
                  <td class="right">{{ -1|format_currency|safe }}</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td>Total</td>
                  <td class="right">{{ sums.virtual|format_currency|safe }}</td>
                </tr>
              </tfoot>
            </table>
          </div>
          <div class="col-md-6">
            <table class="table">
              <thead>
                <tr>
                  <th colspan="2">Cash Accounts</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Chez Betty Cash</td>
                  <td class="right">{{ chezbetty_cash.balance|format_currency|safe }}</td>
                </tr>
                <tr>
                  <td>Cash Box</td>
                  <td class="right">{{ cashbox.balance|format_currency|safe }}</td>
                </tr>
                <tr>
                  <td>Coinbase</td>
                  <td class="right">{{ btc_balance.mbtc }} mBTC ({{ btc_balance.usd|format_currency|safe }})</td>
                </tr>
                <tr>
                  <td>Lost/Stolen Cash</td>
                  <td class="right">{{ -1|format_currency|safe }}</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td>Total</td>
                  <td class="right">{{ sums.cash|format_currency|safe }}</td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="col-md-3">

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Assets</h3>
      </div>
      <div class="panel-body">

        <table class="table">
          <tbody>
            <tr>
              <td>Cash</td>
              <td class="right">{{ chezbetty_cash.balance|format_currency|safe }}</td>
            </tr>
            <tr>
              <td>Inventory (Wholesale)</td>
              <td class="right">{{ inventory.wholesale|format_currency|safe }}</td>
            </tr>
            <tr>
              <td>Inventory (Price)</td>
              <td class="right">{{ inventory.price|format_currency|safe }}</td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Low Stock Items</h3>
      </div>
      <div class="panel-body">
        <table class="table table-condensed table-striped">
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">In Stock</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr>
              <td>{{ item.name }}</td>
              <td class="right">{{ item.in_stock }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wall of Shame Overview</h3>
      </div>
      <div class="panel-body">
        <table class="table table-condensed table-striped">
          <thead>
            <tr>
              <th>User</th>
              <th class="right">Balance</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users %}
            <tr>
              <td>{{ user.name }}</td>
              <td class="right">{{ user.balance|format_currency|safe }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Best Selling Items</h3>
      </div>
      <div class="panel-body">
        <table class="table table-condensed table-striped">
          <thead>
            <tr>
              <th>Item</th>
              <th>Quantity Sold</th>
            </tr>
          </thead>
          <tbody>
            {% for item in best_selling_items %}
            <tr>
              <td>{{ item.name }}</td>
              <td>{{ item.quantity }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

      </div>
    </div>
  </div>
</div>

<div class="row">

  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent Transactions</h3>
      </div>
      <div class="panel-body">
        <table class="table table-condensed table-striped">
          <thead>
            <tr>
              <th></th>
              <th>ID</th>
              <th>Timestamp</th>
              <th>Type</th>
              <th>From Account:</th>
              <th>To Account:</th>
              <th>From Account (Cash):</th>
              <th>To Account (Cash):</th>
              <th class="right">Amount</th>
            </tr>
          </thead>
          <tbody>
            {% for e in events %}
            {% set t = e.transaction[0] %}
            <tr>
              <td><a href="/admin/transactions/{{ t.id }}"><button type="button" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-search"></span></button></a></td>
              <td>{{ t.id }}</td>
              <td>{{ e.timestamp|pretty_date|safe }}</td>
              <td>{{ t.type }}</td>
              <td>{{ t.fr_account_virt.name if t.fr_account_virt else "n/a" }}</td>
              <td>{{ t.to_account_virt.name if t.to_account_virt else "n/a" }}</td>
              <td>{{ t.fr_account_cash.name if t.fr_account_cash else "n/a" }}</td>
              <td>{{ t.to_account_cash.name if t.to_account_cash else "n/a" }}</td>
              <td class="right">{{ t.amount|format_currency|safe }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        </div>
    </div>
  </div>

</div>


{% endblock %}
