{% extends "base.jinja2" %}
{% block title %}User Information{% endblock %}


{% block top %}

<div class="container">
  <h1>{{ user.name }}</h1>
</div>

{% endblock %}


{% block content %}

{{ user_info_block|safe }}

{# Display the transaction history list
 #}
<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Transaction History</h3>
  </div>
  <div class="panel-body">

    <ul id="transaction-history" class="list-group">

      
      {# Iterate all of the transactions in the user's history.
       #}
      {% for transaction in transactions %}

      <li class="list-group-item">
        {{ transaction.type }} | {{ transaction.date }}
        <button type="button" class="btn btn-default">Show</button>

        {# Choose what content to display based on the type of transaction
         # it is.
         #}
        {% if transaction.type == "purchase" %}

        {# Show a purchase transaction
         #}
        <div id="transaction-{{ transaction.id }}" class="hidden">
          <table class="table">

            <thead>
              <tr>
                <th>Item Name</th>
                <th>Quantity</th>
                <th>Price</th>
              </tr>
            </thead>

            <tbody>
              {{ transaction.items_html }}
            </tbody>

            <tfoot>
              <td colspan="2">Total</td>
              <td>{{ transaction.total }}</td>
            </tfoot>

          </table>
        </div>

        {% elif transaction.type == "deposit" %}

        {# Show a deposit transaction
         #}
        <div id="transaction-{{ transaction.id }}" class="hidden">
          <div class="row">
            <div class="col-md-4">Old Balance</div>
            <div class="col-md-4">{{ transaction.old_balance }}</div>
          </div>
          <div class="row">
            <div class="col-md-4">Deposit</div>
            <div class="col-md-4">{{ transaction.deposit_amount }}</div>
          </div>
          <div class="row">
            <div class="col-md-4">New Balance</div>
            <div class="col-md-4">{{ transaction.new_balance }}</div>
          </div>
        </div>

        {% endif %}

      </li>

      {% endfor %}

      {% if transactions|length == 0 %}
      <li class="list-group-item">
        No transactions.
      </li>
      {% endif %}

    </ul>

  </div>
</div>

{% endblock %}

